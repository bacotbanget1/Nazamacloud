<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nazama AI - Chatbot Cerdas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* CSS sama seperti sebelumnya */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #10a37f;
            --primary-dark: #0d8a6c;
            --bg-color: #ffffff;
            --sidebar-bg: #f7f7f8;
            --text-color: #343541;
            --text-light: #6e6e80;
            --border-color: #e5e5e7;
            --user-msg-bg: #f7f7f8;
            --ai-msg-bg: #ffffff;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        .sidebar {
            width: 260px;
            background-color: var(--sidebar-bg);
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
            transition: transform 0.3s ease;
        }

        .logo-container {
            padding: 20px 16px;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, #10a37f, #1a73e8);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            position: relative;
            overflow: hidden;
        }

        .logo:before {
            content: "ðŸ¦…";
            font-size: 20px;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-color);
        }

        .new-chat-btn {
            margin: 16px;
            padding: 10px 16px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            cursor: pointer;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .new-chat-btn:hover {
            background-color: var(--primary-dark);
        }

        .chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .chat-history-item {
            padding: 10px 12px;
            border-radius: 6px;
            margin-bottom: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-light);
            transition: background-color 0.2s;
        }

        .chat-history-item:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .chat-history-item.active {
            background-color: rgba(16, 163, 127, 0.1);
            color: var(--primary-color);
        }

        .sidebar-footer {
            padding: 16px;
            border-top: 1px solid var(--border-color);
            font-size: 14px;
            color: var(--text-light);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .chat-header {
            padding: 16px 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chat-title {
            font-size: 18px;
            font-weight: 600;
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .message {
            display: flex;
            gap: 20px;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        .user-message {
            background-color: var(--user-msg-bg);
            border-radius: 12px;
            padding: 16px;
        }

        .ai-message {
            background-color: var(--ai-msg-bg);
            border-radius: 12px;
            padding: 16px;
            box-shadow: var(--shadow);
        }

        .avatar {
            width: 32px;
            height: 32px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .user-avatar {
            background-color: #10a37f;
            color: white;
        }

        .ai-avatar {
            background: linear-gradient(135deg, #10a37f, #1a73e8);
            color: white;
        }

        .message-content {
            flex: 1;
            line-height: 1.6;
        }

        .message-content p {
            margin-bottom: 12px;
        }

        .message-content p:last-child {
            margin-bottom: 0;
        }

        .attachments {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 12px;
        }

        .attachment {
            display: flex;
            align-items: center;
            gap: 6px;
            background-color: rgba(0, 0, 0, 0.05);
            padding: 6px 10px;
            border-radius: 6px;
            font-size: 14px;
        }

        .attachment img {
            max-width: 200px;
            border-radius: 6px;
        }

        .input-container {
            padding: 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .input-box {
            width: 100%;
            max-width: 800px;
            position: relative;
        }

        .input-actions {
            display: flex;
            gap: 8px;
            margin-bottom: 12px;
        }

        .action-btn {
            background: none;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 6px 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 14px;
            color: var(--text-light);
            transition: all 0.2s;
        }

        .action-btn:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .text-input {
            width: 100%;
            min-height: 56px;
            max-height: 200px;
            padding: 16px 50px 16px 16px;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            resize: none;
            font-size: 16px;
            line-height: 1.5;
            outline: none;
            transition: border-color 0.2s;
        }

        .text-input:focus {
            border-color: var(--primary-color);
        }

        .send-btn {
            position: absolute;
            right: 12px;
            bottom: 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .send-btn:hover {
            background-color: var(--primary-dark);
        }

        .disclaimer {
            margin-top: 16px;
            font-size: 12px;
            color: var(--text-light);
            text-align: center;
            max-width: 800px;
        }

        @media (max-width: 768px) {
            .sidebar {
                position: absolute;
                z-index: 100;
                height: 100%;
                transform: translateX(-100%);
            }

            .sidebar.active {
                transform: translateX(0);
            }

            .menu-toggle {
                display: block;
                background: none;
                border: none;
                font-size: 20px;
                cursor: pointer;
                color: var(--text-color);
            }
        }

        .typing-indicator {
            display: flex;
            align-items: center;
            gap: 4px;
            margin-top: 8px;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--text-light);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }

        @keyframes typing {
            0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; }
            40% { transform: scale(1); opacity: 1; }
        }

        .file-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 12px;
        }

        .preview-item {
            position: relative;
            display: inline-block;
        }

        .preview-item img {
            max-width: 150px;
            border-radius: 6px;
        }

        .remove-btn {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #ff4d4f;
            color: white;
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
        }

        .api-key-container {
            padding: 10px 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .api-key-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 14px;
            background-color: white;
        }

        .api-key-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="logo-container">
            <div class="logo"></div>
            <div class="logo-text">Nazama AI</div>
        </div>
        
        <div class="api-key-container">
            <input type="password" class="api-key-input" id="apiKeyInput" placeholder="Masukkan API Key DeepSeek Anda di sini">
        </div>
        
        <button class="new-chat-btn">
            <i class="fas fa-plus"></i> Obrolan Baru
        </button>
        
        <div class="chat-history">
            <div class="chat-history-item active">
                <i class="fas fa-message"></i>
                <span>Obrolan Saat Ini</span>
            </div>
            <div class="chat-history-item">
                <i class="fas fa-message"></i>
                <span>Tips Penggunaan AI</span>
            </div>
            <div class="chat-history-item">
                <i class="fas fa-message"></i>
                <span>Panduan Nazama AI</span>
            </div>
        </div>
        
        <div class="sidebar-footer">
            <p>Nazama AI v1.0</p>
            <p>Powered by DeepSeek API</p>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
        <div class="chat-header">
            <div class="chat-title">Nazama AI Assistant</div>
            <button class="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        
        <div class="chat-container" id="chatContainer">
            <div class="message ai-message">
                <div class="avatar ai-avatar">
                    <i class="fas fa-eagle"></i>
                </div>
                <div class="message-content">
                    <p>Halo! Saya Nazama AI, asisten AI Anda yang siap membantu. Silakan masukkan API Key DeepSeek Anda di sidebar untuk mulai menggunakan layanan.</p>
                    <p>Setelah memasukkan API Key, Anda dapat mengirim pesan, gambar, atau file kepada saya.</p>
                </div>
            </div>
        </div>
        
        <div class="input-container">
            <div class="input-box">
                <div class="input-actions">
                    <button class="action-btn" id="uploadImageBtn">
                        <i class="fas fa-image"></i> Gambar
                    </button>
                    <button class="action-btn" id="uploadFileBtn">
                        <i class="fas fa-file"></i> File
                    </button>
                </div>
                
                <div class="file-preview" id="filePreview"></div>
                
                <textarea class="text-input" id="textInput" placeholder="Ketik pesan Anda di sini..."></textarea>
                <button class="send-btn" id="sendBtn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            
            <div class="disclaimer">
                Nazama AI dapat membuat kesalahan. Harap periksa informasi penting.
            </div>
        </div>
    </div>

    <script>
        // ================================
        // KONFIGURASI API - ISI DI SINI
        // ================================
        
        // Tambahkan API Key DeepSeek Anda di sini:
        const DEEPSEEK_API_KEY = 'sk-28bfd82aa9bd422391bd88eac97c2489'; // Isi dengan API key Anda
        
        // Atau gunakan input dari user:
        function getApiKey() {
            const inputKey = document.getElementById('apiKeyInput').value.trim();
            return inputKey || DEEPSEEK_API_KEY;
        }
        
        const DEEPSEEK_API_URL = 'https://api.deepseek.com/v1/chat/completions'; // Ganti dengan endpoint yang benar
        
        // ================================
        // KODE APLIKASI CHATBOT
        // ================================

        // DOM Elements
        const chatContainer = document.getElementById('chatContainer');
        const textInput = document.getElementById('textInput');
        const sendBtn = document.getElementById('sendBtn');
        const uploadImageBtn = document.getElementById('uploadImageBtn');
        const uploadFileBtn = document.getElementById('uploadFileBtn');
        const filePreview = document.getElementById('filePreview');
        const newChatBtn = document.querySelector('.new-chat-btn');
        const menuToggle = document.querySelector('.menu-toggle');
        const sidebar = document.querySelector('.sidebar');
        const apiKeyInput = document.getElementById('apiKeyInput');

        // File handling
        let uploadedFiles = [];

        // Event Listeners
        sendBtn.addEventListener('click', sendMessage);
        textInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });

        uploadImageBtn.addEventListener('click', () => {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = 'image/*';
            input.onchange = handleFileUpload;
            input.click();
        });

        uploadFileBtn.addEventListener('click', () => {
            const input = document.createElement('input');
            input.type = 'file';
            input.onchange = handleFileUpload;
            input.click();
        });

        newChatBtn.addEventListener('click', startNewChat);
        menuToggle.addEventListener('click', toggleSidebar);

        // Functions
        function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file) return;

            uploadedFiles.push(file);
            displayFilePreview(file);
        }

        function displayFilePreview(file) {
            const previewItem = document.createElement('div');
            previewItem.className = 'preview-item';
            
            if (file.type.startsWith('image/')) {
                const img = document.createElement('img');
                img.src = URL.createObjectURL(file);
                previewItem.appendChild(img);
            } else {
                const fileIcon = document.createElement('div');
                fileIcon.className = 'attachment';
                fileIcon.innerHTML = `<i class="fas fa-file"></i> ${file.name}`;
                previewItem.appendChild(fileIcon);
            }
            
            const removeBtn = document.createElement('button');
            removeBtn.className = 'remove-btn';
            removeBtn.innerHTML = '<i class="fas fa-times"></i>';
            removeBtn.onclick = () => {
                uploadedFiles = uploadedFiles.filter(f => f !== file);
                filePreview.removeChild(previewItem);
            };
            
            previewItem.appendChild(removeBtn);
            filePreview.appendChild(previewItem);
        }

        async function sendMessage() {
            const message = textInput.value.trim();
            if (message === '' && uploadedFiles.length === 0) return;

            // Add user message to chat
            addMessageToChat('user', message, uploadedFiles);
            
            // Clear input and file previews
            textInput.value = '';
            filePreview.innerHTML = '';
            uploadedFiles = [];
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                // Get API response
                const aiResponse = await getAIResponse(message);
                removeTypingIndicator();
                addMessageToChat('ai', aiResponse);
            } catch (error) {
                removeTypingIndicator();
                addMessageToChat('ai', 'Maaf, terjadi error. Pastikan API key sudah benar dan koneksi internet stabil.');
                console.error('Error:', error);
            }
        }

        async function getAIResponse(userMessage) {
            const apiKey = getApiKey();
            
            if (!apiKey) {
                return 'Silakan masukkan API Key DeepSeek Anda di sidebar terlebih dahulu.';
            }

            // Implementasi panggilan API ke DeepSeek
            // CATATAN: Anda perlu menyesuaikan dengan format API DeepSeek yang sebenarnya
            try {
                const response = await fetch(DEEPSEEK_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'deepseek-chat', // Ganti dengan model yang sesuai
                        messages: [
                            {
                                role: 'user',
                                content: userMessage
                            }
                        ],
                        max_tokens: 1000
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                return data.choices[0].message.content;
            } catch (error) {
                console.error('API Error:', error);
                
                // Fallback response jika API error
                const responses = [
                    "Saya memahami pertanyaan Anda. Berdasarkan informasi yang diberikan, saya dapat menjelaskan bahwa Nazama AI adalah asisten cerdas yang dirancang untuk membantu berbagai kebutuhan Anda.",
                    "Terima kasih telah mengirimkan pertanyaan. Saat ini saya sedang menggunakan mode simulasi. Dengan API key yang valid, saya dapat memberikan respons yang lebih akurat dan kontekstual.",
                    "Pertanyaan yang bagus! Untuk mendapatkan respons AI yang sesungguhnya, pastikan Anda telah memasukkan API Key DeepSeek yang valid.",
                    "Saya melihat Anda mengunggah file/gambar. Dengan API yang tepat, Nazama AI dapat menganalisis konten visual dan tekstual untuk memberikan bantuan yang lebih komprehensif."
                ];
                
                return responses[Math.floor(Math.random() * responses.length)] + 
                       " [SIMULASI - Pastikan API key sudah diisi dengan benar]";
            }
        }

        function addMessageToChat(sender, message, files = []) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}-message`;
            
            const avatar = document.createElement('div');
            avatar.className = `avatar ${sender}-avatar`;
            avatar.innerHTML = sender === 'user' 
                ? '<i class="fas fa-user"></i>' 
                : '<i class="fas fa-eagle"></i>';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            if (message) {
                const messageText = document.createElement('p');
                messageText.textContent = message;
                contentDiv.appendChild(messageText);
            }
            
            if (files.length > 0) {
                const attachmentsDiv = document.createElement('div');
                attachmentsDiv.className = 'attachments';
                
                files.forEach(file => {
                    if (file.type.startsWith('image/')) {
                        const img = document.createElement('img');
                        img.src = URL.createObjectURL(file);
                        attachmentsDiv.appendChild(img);
                    } else {
                        const fileDiv = document.createElement('div');
                        fileDiv.className = 'attachment';
                        fileDiv.innerHTML = `<i class="fas fa-file"></i> ${file.name}`;
                        attachmentsDiv.appendChild(fileDiv);
                    }
                });
                
                contentDiv.appendChild(attachmentsDiv);
            }
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(contentDiv);
            chatContainer.appendChild(messageDiv);
            
            // Scroll to bottom
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function showTypingIndicator() {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message ai-message';
            messageDiv.id = 'typingIndicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'avatar ai-avatar';
            avatar.innerHTML = '<i class="fas fa-eagle"></i>';
            
            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.innerHTML = `
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            `;
            
            contentDiv.appendChild(typingDiv);
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(contentDiv);
            chatContainer.appendChild(messageDiv);
            
            // Scroll to bottom
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typingIndicator');
            if (typingIndicator) {
                chatContainer.removeChild(typingIndicator);
            }
        }

        function startNewChat() {
            // Clear chat container except for the first AI message
            const initialMessage = chatContainer.querySelector('.ai-message');
            chatContainer.innerHTML = '';
            if (initialMessage) {
                chatContainer.appendChild(initialMessage);
            }
            
            // Clear any file previews
            filePreview.innerHTML = '';
            uploadedFiles = [];
        }

        function toggleSidebar() {
            sidebar.classList.toggle('active');
        }

        // Auto-resize textarea
        textInput.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = (this.scrollHeight) + 'px';
        });

        // Simpan API key di localStorage
        apiKeyInput.addEventListener('change', function() {
            localStorage.setItem('nazama_api_key', this.value);
        });

        // Load saved API key
        window.addEventListener('load', function() {
            const savedKey = localStorage.getItem('nazama_api_key');
            if (savedKey) {
                apiKeyInput.value = savedKey;
            }
        });
    </script>
</body>
</html>
